load python3 23-06 for pytorch (with numpy 1.24.3, scikit-learn 1.2.2, torch 1.12.1,  more details: pip list)
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/8
Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/8
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/8
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/8
Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/8
Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/8
Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/8
wandb: Currently logged in as: aghiles-kebaili. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in ./wandb/run-20230619_152402-mzxqibfh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Training
wandb: ‚≠êÔ∏è View project at https://wandb.ai/aghiles-kebaili/discrimnative-hvae-for-accurate-tumor-segmentation
wandb: üöÄ View run at https://wandb.ai/aghiles-kebaili/discrimnative-hvae-for-accurate-tumor-segmentation/runs/mzxqibfh
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name               | Type                    | Params
---------------------------------------------------------------
0 | encoder            | Encoder                 | 35.2 M
1 | decoder            | Decoder                 | 26.9 M
2 | positional_encoder | TimePositionalEmbedding | 0     
3 | regularization     | LPIPSWithDiscriminator  | 17.5 M
---------------------------------------------------------------
64.8 M    Trainable params
14.7 M    Non-trainable params
79.5 M    Total params
318.174   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
SLURM auto-requeueing enabled. Setting signal handlers.
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    self.advance(data_fetcher)
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
Traceback (most recent call last):
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
Traceback (most recent call last):
  File "/gpfs1/home/2021012/sruan01/riles/discriminative-hvae-for-accurate-tumor-segmentation/main.py", line 75, in <module>
    trainer.fit(model=model, datamodule=datamodule)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 531, in fit
    call._call_and_handle_interrupt(
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 41, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 91, in launch
    return function(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 570, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 975, in _run
    results = self._run_stage()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1018, in _run_stage
    self.fit_loop.run()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 220, in advance
    batch_output = self.manual_optimization.run(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 90, in run
    self.advance(kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/manual.py", line 109, in advance
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 287, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/2021012/sruan01/riles/env/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 328, in training_step
    return self.model(*args, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/soft/Python3-DL/conda_envs/torch112/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 994, in forward
    if torch.is_grad_enabled() and self.reducer._rebuild_buckets():
RuntimeError: It looks like your LightningModule has parameters that were not used in producing the loss returned by training_step. If this is intentional, you must enable the detection of unused parameters in DDP, either by setting the string value `strategy='ddp_find_unused_parameters_true'` or by setting the flag in the strategy with `strategy=DDPStrategy(find_unused_parameters=True)`.
srun: error: my380: tasks 4-7: Exited with exit code 1
srun: Terminating job step 9575483.0
slurmstepd: error: *** STEP 9575483.0 ON my379 CANCELLED AT 2023-06-19T15:25:03 ***
srun: error: my379: tasks 1-3: Exited with exit code 1
srun: error: my379: task 0: Terminated
srun: Force Terminated job step 9575483.0
